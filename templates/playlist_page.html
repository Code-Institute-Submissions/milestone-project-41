{% extends "base.html" %} {% block content %}
<div class="row">
	<div class="col s12">
		<h2>Playlist</h2>
	</div>
</div>

<!-- <div class="row">
	<div class="col s12">
		<iframe width="640" height="360" src="{{'https://www.youtube.com/embed/' ~ users.playlist[0] ~ '?enablejsapi=1'}}" frameborder="0" ></iframe>
        <iframe width="640" height="360" src="{{'https://www.youtube.com/embed/US0jUNjFgUg?enablejsapi=1'}}" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen frameborder="0" ></iframe>
	</div>
</div> -->

<div class="row">
	<div class="col s12 m8">
		<div class="video-container">
			<!-- <iframe id="iframe-demo" width="640" height="360"
				src="{{'https://www.youtube.com/embed/' ~ users.playlist[0] ~ '?autoplay=1'}}"
				allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen
				frameborder="0" style="border: solid 4px #37474F"></iframe> -->
                <div id="player"></div>
		</div>
	</div>
	<div class="col s12 m4">
		<ul class="collection with-header">
			<li class="collection-header">
				<h5>Upcoming songs</h5>
			</li>
			<br>
            {% for song in users.playlist %}
                {% if song !=users.playlist[0] %}
			<li class="collection-item">{{song}}</li>
			{% endif %}
			{% endfor %}
		</ul>
	</div>
</div>


<script type="text/javascript">
	var tag = document.createElement('script');
  tag.id = 'iframe-demo';
  tag.src = 'https://www.youtube.com/iframe_api';
  var firstScriptTag = document.getElementsByTagName('script')[0];
  firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);

  var player;
  function onYouTubeIframeAPIReady() {
    player = new YT.Player('player', {
        videoId: '{{users.playlist[0]}}',
        playerVars: { 'autoplay': 1, 'controls': 1 },
        events: {
          'onReady': onPlayerReady,
          'onStateChange': onPlayerStateChange
        }
    });
  }
  function onPlayerReady(event) {
    document.getElementById('player').style.borderColor = '#FF6D00';
  }

  function onPlayerStateChange(event) {
    if (event.data == YT.PlayerState.ENDED) {   
           player.loadVideoById ('{{users.playlist[1]}}');
        } 
  }
</script>


{% endblock %}